library(soilDB)

## problem tiles
# [1]  63 152 153 154 230 231 232 233 234 235 236 237 248 249 250 251 252 271 272 273 274


v <- c("sandtotal_r", "silttotal_r", "claytotal_r", "ph1to1h2o_r", "wthirdbar_r", "wfifteenbar_r")

.mukey <- c(342070, 342071, 342072, 342074, 342075, 342093, 342097, 342098, 
            342099, 342100, 342102, 342103, 342104, 342105, 342106, 342107, 
            342109, 342111, 342113, 342114, 342115, 342116, 342117, 342118, 
            342120, 342124, 342125, 342126, 342127, 342128, 342130, 342131, 
            342132, 342138, 342141, 342144, 342146, 342151, 342156, 342157, 
            342158, 342159, 342163, 342168, 342174, 342175, 342178, 342179, 
            342180, 342181, 342182, 342183, 342184, 342189, 342190, 342193, 
            342194, 342206, 342210, 342211, 342216, 342218, 342220, 342234, 
            342235, 342243, 342244, 342245, 342248, 342251, 342252, 342254, 
            342255, 342256, 342257, 342258, 342260, 342267, 342272, 342273, 
            342275, 342276, 342278, 342279, 342280, 342282, 342283, 342284, 
            342285, 342287, 342289, 342291, 342292, 342293, 342297, 342298, 
            342299, 342300, 342301, 342302, 342303, 342304, 342307, 342309, 
            342310, 342312, 342313, 342314, 342315, 342322, 342837, 342841, 
            342842, 342845, 342849, 342853, 342855, 342860, 342862, 342863, 
            342869, 342871, 342878, 342882, 342883, 342887, 342889, 342893, 
            342894, 342895, 342901, 342909, 342911, 342913, 342915, 342917, 
            342919, 342921, 342922, 342924, 342927, 342928, 342929, 342931, 
            342933, 342937, 342938, 342940, 342941, 342946, 342949, 342956, 
            342957, 342959, 342960, 342962, 342965, 342967, 342968, 342970, 
            342972, 342975, 342977, 342986, 342988, 342990, 342992, 342993, 
            343001, 343006, 343011, 343013, 343014, 343016, 343024, 343026, 
            343027, 343028, 343029, 343031, 343032, 343033, 343034, 343036, 
            343037, 343038, 343040, 343044, 343046, 343048, 343049, 343050, 
            343054, 343055, 343056, 343058, 343059, 343060, 343062, 343063, 
            343064, 343065, 343066, 343068, 343069, 343073, 343076, 343079, 
            343082, 343084, 343088, 343090, 343091, 343092, 343093, 343094, 
            343096, 343099, 343102, 343103, 343107, 343108, 343110, 343116, 
            343122, 343125, 343127, 343128, 343134, 343138, 343140, 343141, 
            343143, 343144, 343146, 343148, 343151, 343152, 343154, 343156, 
            343157, 343161, 343162, 343163, 343164, 343165, 343167, 343169, 
            343170, 343172, 343174, 343176, 343178, 343179, 343180, 343182, 
            343183, 343186, 343189, 343191, 343192, 343193, 343199, 343201, 
            343202, 343204, 343211, 343212, 343216, 343217, 343220, 343223, 
            343224, 343228, 343229, 343231, 343232, 343235, 343237, 343238, 
            343240, 343241, 343245, 343250, 343251, 343252, 343254, 343255, 
            343256, 343258, 343259, 343261, 343262, 343265, 343266, 343270, 
            343271, 343274, 343275, 343277, 343278, 343280, 343285, 343286, 
            343288, 343289, 343291, 343293, 343295, 343298, 343301, 343302, 
            343305, 343306, 343309, 343319, 343324, 343329, 343330, 343331, 
            343332, 343336, 343345, 343350, 343354, 343356, 343363, 343364, 
            343366, 343367, 343376, 343378, 343379, 343380, 343381, 343386, 
            343391, 343393, 343394, 343400, 343401, 343403, 343404, 343406, 
            343409, 343421, 343423, 343424, 343425, 343426, 343431, 343432, 
            343433, 343437, 343439, 343440, 343442, 343443, 343447, 343453, 
            343456, 343459, 343461, 343465, 343467, 343473, 343474, 343476, 
            343479, 343485, 343488, 343491, 343496, 343497, 343500, 343501, 
            343504, 343505, 343507, 343509, 343512, 343514, 343517, 343518, 
            343523, 343524, 343527, 343529, 343530, 343531, 343536, 343538, 
            343541, 343547, 343548, 343549, 343550, 343551, 343552, 343553, 
            343554, 343556, 343557, 343564, 343575, 343589, 343592, 343594, 
            343595, 343597, 343601, 343604, 343605, 343606, 343608, 343630, 
            343632, 343638, 343643, 343646, 343649, 343650, 343651, 343656, 
            343657, 343658, 343659, 343661, 343663, 343667, 343670, 343684, 
            343685, 343689, 343690, 343691, 343692, 343693, 343696, 343697, 
            343700, 343701, 343706, 343712, 343721, 343723, 343724, 343726, 
            343727, 343728, 343729, 343730, 343732, 343733, 343734, 343743, 
            343749, 343751, 343755, 343756, 343757, 343764, 343792, 343800, 
            343810, 343816, 343823, 343824, 343825, 343827, 343834, 343836, 
            343844, 347833, 347834, 347835, 347836, 347837, 347838, 347840, 
            347841, 347842, 347843, 347844, 347845, 347847, 347848, 347849, 
            347850, 347853, 347854, 347855, 347856, 347857, 347858, 347859, 
            347860, 347861, 347862, 347863, 347864, 347865, 347866, 347867, 
            347868, 347869, 347870, 347871, 347872, 347873, 347874, 347875, 
            347876, 347877, 347878, 347879, 347880, 347881, 347882, 347883, 
            347884, 347885, 347886, 347887, 347888, 347889, 347890, 347891, 
            347892, 347893, 347894, 347895, 347896, 347897, 347898, 347899, 
            347901, 347902, 347903, 347904, 347905, 347906, 347907, 347908, 
            347909, 347910, 347911, 347912, 347913, 347914, 347915, 347916, 
            347917, 347918, 349176, 349177, 349178, 349179, 349180, 349181, 
            349182, 349183, 349185, 349186, 349187, 349189, 349198, 349199, 
            349202, 349203, 349204, 349205, 349206, 349207, 349209, 349210, 
            349211, 349212, 349213, 349216, 349217, 349218, 349219, 349220, 
            349221, 349222, 349223, 349225, 349226, 349227, 349228, 349229, 
            349230, 349231, 349232, 349233, 349236, 349238, 349239, 349240, 
            349241, 349242, 349243, 349244, 349245, 349247, 349248, 349249, 
            349250, 349252, 349253, 349254, 349255, 349258, 349259, 349264, 
            349265, 349266, 349267, 349268, 349269, 349271, 349273, 349274, 
            349275, 349276, 349277, 349278, 349279, 349280, 349281, 349282, 
            349286, 349287, 349289, 349290, 349292, 349293, 349294, 349299, 
            349300, 349301, 349304, 349305, 349306, 349307, 349308, 349309, 
            349310, 349311, 349312, 349313, 349314, 349315, 349316, 349317, 
            349318, 349319, 349322, 349327, 349328, 349330, 349331, 349335, 
            349337, 349338, 349339, 349340, 349341, 349342, 349343, 349344, 
            349345, 349346, 349348, 349351, 349352, 349353, 349354, 349355, 
            349356, 349357, 349358, 349359, 349360, 349361, 349362, 349363, 
            349365, 349366, 349367, 349368, 349370, 349372, 349373, 349377, 
            349378, 349379, 349380, 353134, 353135, 353136, 353141, 353144, 
            353145, 353146, 353147, 353150, 353151, 353154, 353157, 353160, 
            353161, 353162, 353163, 353168, 353170, 353171, 353172, 353173, 
            353174, 353175, 353176, 353177, 353178, 353179, 353180, 353181, 
            353182, 353189, 353190, 353193, 353194, 353195, 353196, 353197, 
            353198, 353201, 353202, 353203, 353206, 353207, 353208, 353210, 
            353211, 353215, 353216, 353217, 353218, 353220, 353221, 353222, 
            353223, 353224, 353226, 353229, 353230, 353236, 353237, 353238, 
            353239, 353240, 353241, 353242, 353243, 353244, 353245, 353246, 
            353247, 353248, 353249, 353250, 353251, 353252, 353254, 353256, 
            353257, 354607, 354608, 354609, 354610, 354612, 354613, 354614, 
            354615, 354616, 354617, 354618, 354619, 354620, 354621, 354623, 
            354624, 354625, 354626, 354627, 354628, 354630, 354631, 354632, 
            354633, 354634, 354635, 354636, 354637, 354638, 354639, 354640, 
            354641, 354642, 354643, 354644, 354645, 354646, 354647, 354648, 
            354649, 354650, 354651, 354652, 354653, 354654, 354656, 354657, 
            354658, 354659, 354660, 354661, 354662, 354663, 354664, 354665, 
            354666, 354668, 354669, 354670, 354672, 354675, 355415, 355416, 
            355417, 355418, 355419, 355420, 355423, 355424, 355425, 355426, 
            355427, 355428, 355429, 355430, 355431, 355432, 355433, 355434, 
            355435, 355436, 355437, 355438, 355440, 355441, 355442, 355443, 
            355444, 355447, 355448, 355450, 355451, 355452, 355453, 355456, 
            355457, 355458, 355459, 355461, 355466, 355469, 355470, 355471, 
            355472, 355473, 355476, 355477, 355709, 355710, 355711, 355712, 
            355714, 355715, 355716, 355717, 355718, 355719, 355720, 355721, 
            355722, 355723, 355724, 355725, 355726, 355727, 355728, 355729, 
            355730, 355731, 355733, 355734, 355735, 355736, 355737, 355738, 
            355739, 355740, 355741, 355742, 355743, 355744, 355745, 355746, 
            355747, 355748, 355749, 355750, 355751, 355752, 355753, 355754, 
            355755, 355756, 355757, 355758, 355759, 355760, 355762, 355763, 
            355764, 355765, 355766, 355767, 355768, 355769, 355770, 355771, 
            355772, 355773, 355774, 355775, 355776, 355777, 355778, 355779, 
            355780, 355781, 355784, 355785, 355786, 355787, 355788, 355789, 
            355790, 355791, 355792, 355793, 355794, 355795, 355796, 355797, 
            355798, 355799, 355800, 355801, 355802, 355803, 355804, 355805, 
            355806, 355807, 355809, 355811, 355812, 355813, 355814, 355815, 
            355816, 355817, 355818, 355819, 355820, 780078, 780091, 780096, 
            780116, 780120, 780124, 780126, 780128, 780138, 780141, 780143, 
            780145, 780147, 780198, 780203, 780205, 780206, 780207, 780212, 
            780213, 780219, 780222, 780223, 780224, 780243, 799193, 799197, 
            800058, 817072, 817085, 817501, 817502, 817506, 817514, 817518, 
            817519, 817520, 817521, 817522, 817523, 817524, 817525, 817526, 
            817527, 817528, 817529, 817530, 817531, 817537, 817547, 817548, 
            817549, 817551, 817556, 817557, 817559, 817560, 817561, 817562, 
            817563, 817564, 817566, 817567, 817568, 817572, 817573, 817574, 
            817582, 817590, 817591, 817592, 817593, 817594, 817595, 817596, 
            817597, 817607, 817608, 817614, 817615, 817616, 817619, 817620, 
            817621, 817623, 817627, 817628, 817629, 817631, 817634, 817635, 
            817636, 817637, 817638, 817639, 817642, 817643, 817644, 817645, 
            817647, 817651, 817652, 817653, 817654, 817655, 850319, 992775, 
            992776, 992777, 992781, 992782, 992783, 992784, 992785, 992786, 
            992787, 992788, 992789, 992790, 992791, 992792, 992793, 992794, 
            992795, 992797, 992798, 992799, 992801, 992802, 992803, 992804, 
            992805, 992807, 992809, 992810, 992812, 992813, 992814, 992816, 
            992817, 992818, 992819, 992820, 992822, 992823, 992824, 992825, 
            992826, 992827, 992828, 992829, 992830, 992831, 992832, 992834, 
            992835, 992836, 992837, 992838, 992839, 992840, 992843, 992844, 
            992846, 992847, 992848, 992849, 992850, 992851, 992853, 992855, 
            992856, 992857, 992858, 992859, 992860, 992861, 992862, 992863, 
            992864, 992866, 992867, 992870, 992871, 992873, 992874, 992875, 
            992876, 992877, 992878, 992879, 992880, 992881, 992882, 992883, 
            992884, 992885, 992886, 992887, 992889, 992890, 992891, 992892, 
            992893, 992894, 992895, 992896, 992897, 992898, 992899, 992900, 
            992905, 992909, 992914, 992915, 992916, 992917, 992918, 992920, 
            992922, 992923, 992924, 992926, 992927, 992928, 992929, 992930, 
            992931, 1013843, 1014247, 1014252, 1387738, 1387739, 1387741, 
            1387742, 1387747, 1387749, 1387750, 1387752, 1387756, 1387757, 
            1387758, 1387760, 1387762, 1387768, 1387773, 1387774, 1387775, 
            1387776, 1387779, 1389172, 1389173, 2431132, 2431185, 2438907, 
            2439190, 2439191, 2439203, 2439229, 2439230, 2439238, 2439239, 
            2439252, 2439253, 2439254, 2439255, 2439261, 2439262, 2439267, 
            2439268, 2439269, 2440028, 2440029, 2440034, 2440102, 2440103, 
            2440137, 2441273, 2494708, 2513754, 2513757, 2513942, 2525719, 
            2525720, 2525721, 2525722, 2525723, 2525724, 2525725, 2525726, 
            2525727, 2525728, 2525729, 2525730, 2525731, 2525732, 2525733, 
            2525734, 2525735, 2525736, 2525737, 2525738, 2525739, 2525740, 
            2525741, 2525742, 2525743, 2525744, 2525745, 2525746, 2525747, 
            2525748, 2525749, 2525750, 2525751, 2525752, 2525753, 2525754, 
            2525755, 2525756, 2525757, 2525758, 2525759, 2525760, 2525761, 
            2525762, 2525763, 2525764, 2525765, 2525766, 2525767, 2525768, 
            2525769, 2525770, 2547434, 2547435, 2547436, 2547447, 2547452, 
            2547454, 2547455, 2547458, 2563512, 2563513, 2563514, 2563515, 
            2563516, 2563517, 2563518, 2563519, 2563520, 2563521, 2563522, 
            2563523, 2563524, 2563525, 2563526, 2563527, 2563528, 2563529, 
            2563530, 2563531, 2563532, 2563533, 2563534, 2563535, 2563536, 
            2563537, 2563538, 2563539, 2563540, 2563541, 2563542, 2563543, 
            2563544, 2563545, 2563546, 2563547, 2563548, 2563549, 2563550, 
            2563551, 2563552, 2563553, 2563554, 2563555, 2563556, 2563557, 
            2563558, 2563559, 2563560, 2563561, 2563563, 2563564, 2563565, 
            2563566, 2563567, 2563568, 2563569, 2563570, 2563571, 2563572, 
            2563573, 2563574, 2563575, 2563576, 2563577, 2563578, 2563579, 
            2563580, 2563581, 2563582, 2563583, 2563585, 2563586, 2563587, 
            2563588, 2563589, 2563590, 2563591, 2563592, 2563593, 2563594, 
            2563595, 2563596, 2563597, 2563598, 2563599, 2563600, 2563601, 
            2563602, 2563603, 2563604, 2563605, 2563606, 2563607, 2563608, 
            2563609, 2563610, 2563611, 2563612, 2563613, 2563614, 2563615, 
            2563616, 2563617, 2563618, 2563619, 2563620, 2563621, 2563622, 
            2563623, 2563624, 2563625, 2563626, 2563627, 2563628, 2563629, 
            2668855, 2699397, 2699400, 2707030, 2707031, 2707032, 2739017, 
            2745705, 2745706, 2745709, 2745712, 2745713, 2745714, 2745715, 
            2745716, 2745717, 2745718, 2745719, 2745721, 2745722, 2745723, 
            2745725, 2745726, 2745727, 2745728, 2745729, 2745730, 2745731, 
            2745732, 2745733, 2745734, 2745735, 2745738, 2745739, 2745741, 
            2745742, 2745743, 2745745, 2745746, 2745747, 2745748, 2745749, 
            2745750, 2745751, 2745752, 2745753, 2745754, 2745755, 2745756, 
            2745757, 2745758, 2745760, 2745761, 2745762, 2745763, 2745765, 
            2745769, 2745771, 2745772, 2745773, 2745775, 2745776, 2745777, 
            2745779, 2745781, 2745782, 2745785, 2745787, 2745788, 2745790, 
            2745791, 2745792, 2745793, 2745794, 2745795, 2745797, 2745798, 
            2745799, 2745800, 2745801, 2745802, 2745803, 2745920, 2745921, 
            2745922, 2745923, 2745924, 2745925, 2745926, 2745927, 2745928, 
            2745929, 2745932, 2745939, 2745940, 2745941, 2745942, 2745943, 
            2745944, 2745945, 2755630, 2755631, 2755633, 2755634, 2755635, 
            2755636, 2755637, 2755638, 2755639, 2755640, 2755643, 2755645, 
            2755646, 2755647, 2755648, 2755650, 2755651, 2755652, 2755653, 
            2755655, 2755661, 2755662, 2755666, 2755667, 2755668, 2755669, 
            2755670, 2758443, 2758445, 2758446, 2758448, 2758449, 2758450, 
            2758451, 2758456, 2758457, 2758458, 2758459, 2758549, 2768031, 
            2768033, 2768034, 2768035, 2768036, 2768037, 2768038, 2768039, 
            2768040, 2768041, 2768048, 2768061, 2768062, 2768063, 2768072, 
            2768073, 2768171, 2768175, 2784556, 2837868, 2837872, 2837927, 
            2837929, 2837972, 2876634, 2876635, 2876637, 2876639, 2876641, 
            2920820, 2920822, 2920823, 2920824, 2926235, 2933137, 2942846, 
            2942849, 2942850, 3040367, 3079037, 3079038, 3079065, 3079086, 
            3256503, 3256594)

# SDA error
x <- get_SDA_property(
  property = v,
  method = "Weighted Average", 
  mukeys = as.integer(.mukey),
  top_depth = 0,
  bottom_depth = 25,
  include_minors = TRUE, 
  miscellaneous_areas = FALSE
)

# works as expected
x <- get_SDA_property(
  property = v,
  method = "none", 
  mukeys = as.integer(.mukey),
  top_depth = 0,
  bottom_depth = 25,
  include_minors = TRUE, 
  miscellaneous_areas = FALSE
)

str(x)







